# Setup the powerlevel10k instant prompt
if [[ -r "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh" ]]; then
  source "${XDG_CACHE_HOME:-$HOME/.cache}/p10k-instant-prompt-${(%):-%n}.zsh"
fi

{{ if eq .chezmoi.hostname "boreas-nebula" -}}
export PATH="$HOME/.local/bin:$HOME/.spicetify:/usr/local/go/bin:$PATH"
{{ else -}}
export PATH="$HOME/.local/bin:$PATH"
{{- end }}

##start oh-my-zsh
export ZSH="$HOME/.oh-my-zsh"

ZSH_THEME="powerlevel10k/powerlevel10k"
DISABLE_MAGIC_FUNCTIONS="true"
zstyle ':omz:update' mode disabled  # disable automatic updates

plugins=(
  zsh-edit
  zsh-syntax-highlighting
  zsh-autosuggestions
  zsh-bash-completions-fallback
)

fpath+=${ZSH_CUSTOM:-${ZSH:-$HOME/.oh-my-zsh}/custom}/plugins/zsh-completions/src

source $ZSH/oh-my-zsh.sh
##end oh-my-zsh

export EDITOR="nvim"

eval "$(chezmoi completion zsh)"
alias cm=chezmoi

alias gs="git status"
alias gd="git diff"
alias gds="git diff --staged"
alias gc="git commit"
alias gcm="git commit -m"
alias gca="git commit --amend"
alias ga="git add"
alias gaa="git add ."

{{ if (or (eq .chezmoi.osRelease.id "debian") (eq .chezmoi.osRelease.id "ubuntu")) -}}
if command -v batcat &>/dev/null; then
{{ else -}}
if command -v bat &>/dev/null; then
{{- end }}
  alias cat=bat
  alias man="MANPAGER=\"sh -c 'col -bx | bat -l man -p'\" MANROFFOPT='-c' man"
  alias -g -- -h='-h 2>&1 | bat --language=help --style=plain'
  alias -g -- --help='--help 2>&1 | bat --language=help --style=plain'
fi

if command -v eza &>/dev/null; then
  alias ls=eza
  alias tree="eza -T"
fi

if command -v zoxide &>/dev/null; then
  eval "$(zoxide init --cmd cd zsh)"
fi

unset SSH_AGENT_PID
if [ "${gnupg_SSH_AUTH_SOCK_by:-0}" -ne $$ ]; then
  export SSH_AUTH_SOCK="$(gpgconf --list-dirs agent-ssh-socket)"
fi

export GPG_TTY=$(tty)
gpg-connect-agent updatestartuptty /bye >/dev/null

[[ ! -f ~/.p10k.zsh ]] || source ~/.p10k.zsh
